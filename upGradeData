function upGradeData() {
  //подключение к таблице "firstDay"
  var sheet = SpreadsheetApp.openById("1RuVJoEfM9vBaS6YlxUjRXm02GF7zyH0JVpvHZdGq3c8");
  
  //подключение к нужной странице
  var list = sheet.getSheetByName("Тест_календарь");     
  
  
  //поиск ключевых слов в диапазоне ячеек  
  var textGroup = "группа";
  var textBpt = "бпт";
  var textBptPositive = "бпт+";
  var textNotVisit = "не пришел пришла";
  var textDocument = "справка";
   
  
  
   //поиск загруженного диапазона в таблицу  
  var firstRowRange = list.getLastRow();
  pullEvents();
  var lastRowRange = list.getLastRow();
  var countRow = lastRowRange - firstRowRange; //13
  
 Logger.log(firstRowRange);
 Logger.log(lastRowRange);
 Logger.log(countRow);  
 
  
   //изменение отображения даты, удаление "EET"
  for (var i=0; i<countRow; i++){    
    var getDateCell = list.getRange(firstRowRange+1+i, 1).getValue();   
    var arrayDate = getDateCell.split(" ");   
    var newArrayDate = arrayDate[0] + " " + arrayDate[1]+ " " + arrayDate[2]+ " " + arrayDate[3]+ " " + arrayDate[4];   
    list.getRange(firstRowRange+1+i, 1).setValue(newArrayDate);    
  }   




  
  
  /*
  if (list.getRange(3, 1).createTextFinder("- EEt")){
    Logger.log("перезаписать ячейку без букв");
    //перезаписать ячейку без букв
  }
      
      */  
  //поиск диапазона для загрузки данных
 // var startDate = list.getRange(1, 2).getValue().toLocaleString("ru");        
 // var finishDate = list.getRange(1, 3).getValue().toLocaleString("ru");  
  
  //выборка массива событий из календаря  
 
 // Logger.log(startDate.toDateString());
 // Logger.log(startDate.toTimeString());
 // Logger.log(startDate.toUTCString());
  //Logger.log(startDate);
  //Logger.log(finishDate);
  
  //выборка диапазона

  //покрасить ячейку
 // list.getRange(3, 5).setBackground("green");
  
  
  //https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet
  //https://www.youtube.com/results?search_query=findAll%28%29+google+script
  
  
 // var textFinder = sheet.createTextFinder("Игорь");
//  var firstOccurrence = textFinder.findAll();
// var firstOccurrence = list.getRange(3, 1, 6, 5).createTextFinder("Игорь");
  
 // Logger.log(firstOccurrence);

  
}

function pullEvents() {
  //подключение к "Тест - google calendar"
  //var calendar = CalendarApp.getCalendarById("7bjlkermbm352732svucp4v970@group.calendar.google.com");   
  var calendar = CalendarApp.getCalendarById("smisyuk@gmail.com");
  
  //подключение к таблице "firstDay"
  var sheet = SpreadsheetApp.openById("1RuVJoEfM9vBaS6YlxUjRXm02GF7zyH0JVpvHZdGq3c8");
  
  //подключение к нужной странице
  var list = sheet.getSheetByName("Тест_календарь");  
  
  //поиск диапазона для загрузки данных
  var startDate = list.getRange(1, 2).getValue();        
  var finishDate = list.getRange(1, 3).getValue();  
  
  //выборка массива событий из календаря  
  var events = calendar.getEvents(startDate, finishDate);   
  
 
    //поиск последней строки в таблице
    var lastRow = list.getLastRow();      
            
    //загрузка данных из календаря в таблицу
    list.getRange(lastRow+1, 1).setValue(events[0].getStartTime().toLocaleString("ru"));
    var oldTime = list.getRange(lastRow+1, 1).getValue();  
    
    var startRow = lastRow+1;  
    var startColumn = 2;
    var j=lastRow+2;  
    
    for (var i=0; i<events.length; i++){      
      var newTime = events[i].getStartTime().toLocaleString("ru");
      var man = events[i].getTitle();       
      
      if (newTime == oldTime){
        //вправо        
        list.getRange(startRow, startColumn).setValue(man);
        startColumn++;
      }
      else{
        //вниз            
        list.getRange(j, 1).setValue(newTime) 
        list.getRange(j, 2).setValue(man)                
        j++;
        startRow++;
        startColumn = 3;
        oldTime = newTime;
      } 
    }    
}















