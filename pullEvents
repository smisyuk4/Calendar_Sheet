function pullEvents() {
  //подключение к "Тест - google calendar"   
  var calendar = CalendarApp.getCalendarById("");
  
  //подключение к таблице "firstDay"
  var sheet = SpreadsheetApp.openById("1RuVJoEfM9vBaS6YlxUjRXm02GF7zyH0JVpvHZdGq3c8");
  
  //подключение к нужной странице
  var list = sheet.getSheetByName("Тест_календарь");  
  
  //поиск диапазона для загрузки данных
  var startDate = list.getRange(1, 2).getValue();        
  var finishDate = list.getRange(1, 3).getValue();  
  
  //выборка массива событий из календаря  
  var events = calendar.getEvents(startDate, finishDate);   
  
  //уточнение актуальности действий
  var ui = SpreadsheetApp.getUi();
  var alert = ui.alert("Уверен?", ui.ButtonSet.YES_NO);
  
  if (alert == ui.Button.YES) {    
    //поиск последней строки в таблице
    var lastRow = list.getLastRow();      
    
    //загрузка данных из календаря в таблицу
    list.getRange(lastRow+1, 1).setValue(events[0].getStartTime().toString());
    var oldTime = list.getRange(lastRow+1, 1).getValue();  
    
    var startRow = lastRow+1;  
    var startColumn = 2;
    var j=lastRow+2;  
    
    for (var i=0; i<events.length; i++){      
      var newTime = events[i].getStartTime().toString();
      var man = events[i].getTitle();       
      
      if (newTime == oldTime){
        //вправо        
        list.getRange(startRow, startColumn).setValue(man);
        startColumn++;
      }
      else{
        //вниз            
        list.getRange(j, 1).setValue(newTime) 
        list.getRange(j, 2).setValue(man)                
        j++;
        startRow++;
        startColumn = 3;
        oldTime = newTime;
      } 
    }  
  }//закрытие alert
}

